import{C as E}from"./chunk-OFN7DIZA-h63_2j5d.js";import{c as F,g as L}from"./chunk-DK4WIVY6-CYCbBMOO.js";import{b as N,v as $,K as T,Q as j,r as M,j as e,H as _,_ as v,X as s,Y as h,cp as I,au as u,dU as w}from"./index-bzW-SAbR.js";import{T as D}from"./textarea-D6qDQxMH.js";import{R as p}from"./radio-group-0YWcVqH2.js";var G=({form:a,fieldScope:t=""})=>{var y;const{t:r}=N(),{store:m}=$(),b=T(),c=j({control:a.control,name:`${t}budget.type`})==="spend",g=j({control:a.control,name:`${t}budget.currency_code`}),o=j({control:a.control,name:"application_method.currency_code"}),d=g||o;if(M.useEffect(()=>{a.setValue(`${t}budget.limit`,null),c?a.setValue("campaign.budget.currency_code",o):a.setValue("campaign.budget.currency_code",null)},[o,c]),o){const n=(y=a.getValues().campaign)==null?void 0:y.budget,i=n==null?void 0:n.currency_code;(n==null?void 0:n.type)==="spend"&&i!==o&&a.setValue("campaign.budget.currency_code",o)}return e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8",children:[e.jsxs("div",{children:[e.jsx(_,{children:r("campaigns.create.header")}),e.jsx(v,{size:"small",className:"text-ui-fg-subtle",children:r("campaigns.create.hint")})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(s.Field,{control:a.control,name:`${t}name`,render:({field:n})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:r("fields.name")}),e.jsx(s.Control,{children:e.jsx(h,{...n})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:a.control,name:`${t}campaign_identifier`,render:({field:n})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:r("campaigns.fields.identifier")}),e.jsx(s.Control,{children:e.jsx(h,{...n})}),e.jsx(s.ErrorMessage,{})]})})]}),e.jsx(s.Field,{control:a.control,name:`${t}description`,render:({field:n})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("fields.description")}),e.jsx(s.Control,{children:e.jsx(D,{...n})}),e.jsx(s.ErrorMessage,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(s.Field,{control:a.control,name:`${t}starts_at`,render:({field:n})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("campaigns.fields.start_date")}),e.jsx(s.Control,{children:e.jsx(I,{granularity:"minute",shouldCloseOnSelect:!1,...n})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:a.control,name:`${t}ends_at`,render:({field:n})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("campaigns.fields.end_date")}),e.jsx(s.Control,{children:e.jsx(I,{granularity:"minute",shouldCloseOnSelect:!1,...n})}),e.jsx(s.ErrorMessage,{})]})})]}),e.jsxs("div",{children:[e.jsx(_,{children:r("campaigns.budget.create.header")}),e.jsx(v,{size:"small",className:"text-ui-fg-subtle",children:r("campaigns.budget.create.hint")})]}),e.jsx(s.Field,{control:a.control,name:`${t}budget.type`,render:({field:n})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{tooltip:t!=null&&t.length&&!d?r("promotions.tooltips.campaignType"):void 0,children:r("campaigns.budget.fields.type")}),e.jsx(s.Control,{children:e.jsxs(p,{dir:b,className:"flex gap-x-4 gap-y-3",...n,onValueChange:n.onChange,children:[e.jsx(p.ChoiceBox,{className:"flex-1",value:"usage",label:r("campaigns.budget.type.usage.title"),description:r("campaigns.budget.type.usage.description")}),e.jsx(p.ChoiceBox,{className:"flex-1",value:"spend",label:r("campaigns.budget.type.spend.title"),description:r("campaigns.budget.type.spend.description"),disabled:t!=null&&t.length?!d:!1})]})}),e.jsx(s.ErrorMessage,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[c&&e.jsx(s.Field,{control:a.control,name:`${t}budget.currency_code`,render:({field:{onChange:n,ref:i,...x}})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{tooltip:t!=null&&t.length&&!d?r("promotions.campaign_currency.tooltip"):void 0,children:r("fields.currency")}),e.jsx(s.Control,{children:e.jsxs(u,{dir:b,...x,onValueChange:n,disabled:!!t.length,children:[e.jsx(u.Trigger,{ref:i,children:e.jsx(u.Value,{})}),e.jsx(u.Content,{children:Object.values(F).filter(l=>{var C;return!!((C=m==null?void 0:m.supported_currencies)!=null&&C.find(V=>V.currency_code===l.code.toLocaleLowerCase()))}).map(l=>e.jsx(u.Item,{value:l.code.toLowerCase(),children:l.name},l.code))})]})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:a.control,name:`${t}budget.limit`,render:({field:{onChange:n,value:i,...x}})=>e.jsxs(s.Item,{className:"basis-1/2",children:[e.jsx(s.Label,{tooltip:!d&&c?r("promotions.fields.amount.tooltip"):void 0,children:r("campaigns.budget.fields.limit")}),e.jsx(s.Control,{children:c?e.jsx(w,{min:0,onValueChange:l=>n(l?parseInt(l):""),code:g,symbol:g?L(g):"",...x,value:i,disabled:!d&&c}):e.jsx(h,{type:"number",...x,min:0,value:i,onChange:l=>{n(l.target.value===""?null:parseInt(l.target.value))}},"usage")}),e.jsx(s.ErrorMessage,{})]})}),!c&&e.jsx(s.Field,{control:a.control,name:`${t}budget.attribute`,render:({field:n})=>e.jsxs(s.Item,{className:"basis-1/2",children:[e.jsx(s.Label,{tooltip:r("campaigns.budget.fields.budgetAttributeTooltip"),children:r("campaigns.budget.fields.budgetAttribute")}),e.jsx(s.Control,{children:e.jsx(E,{...n,onChange:i=>{typeof i>"u"?n.onChange(null):n.onChange(i)},allowClear:!0,options:[{label:r("fields.customer"),value:"customer_id"},{label:r("fields.email"),value:"customer_email"}]},"attribute")}),e.jsx(s.ErrorMessage,{})]})})]})]})};export{G as C};
